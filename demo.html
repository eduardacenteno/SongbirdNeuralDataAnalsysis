<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Songbird Data Analysis: Namespace Members</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="flying-owl-clipart-black-and-white-black-bird-md.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Songbird Data Analysis
   </div>
   <div id="projectbrief">A software that allows you to perform analysis on songbirds' neural and vocalization data stored as Spike2 format (.smr).</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="contents">
&#160;<ul>
This page will provide you a little tutorial of how to use our code . For this tutorial we will be using the Jupyter QtConsole (Anaconda). <p> The tutorial about the version that iterates through several folders can be found <a href="demopop.html">here</a>.</p>
  <p>
   <ul>1 - First, you have to open your QtConsole and define the directory to the one where the code can be found in:
     <p><img src="./images/prompt1.png" width="500" height="250"alt="" />
	<br> </br>
	<p>2 - Now, you can run the script with the magic command %run. By doing that, you will be able to use all the functions in the code. 
	<i>* Remember that the files that will be used in the functions have to be either in the same directory of functions.py, or you should change the directory again by using the cd command.</i>
	<p> Now, let's see some examples:
	<ul> <h3> <b> Example 1 - Using read(file): </b> </h3> </u>
	<p> With this function you can read a .smr file and obtain its block. This function will return 2 things: data, data_seg.
	<p><a href="https://i.imgur.com/TNOkZHh.png"><img src="./images/prompt2.png" width="600" height="250" alt="" /></a>
	<br> </br>
	<p> <h3> <b> Example 2 - Using plotplots(file): </b> </h3>
	<p> With this function you can visualize the analogical signals and the spike trains inside the .smr file. <i> *In case you want the plot to be interactive, %matplolib must not be "inline". </i>
	<p><img src="./images/plotplots.png" alt="" />
	<br> </br>
	<p> <h3> <b> Example 3 - Using spectrogram(songfile, beg, end, fs): </b> </h3>
	<p> With this function you can visualize the spectrogram of a motif/syllable. 
	<p><i>* The songfile is a .npy file that contains the analogical signal of the song, created by the function createsave(file). 
	Please check the documentation of createsave(file) to know how to obtain the file.</i>
	<p>Now, in spectrogram(songfile, beg, end, fs), one will need the value in sample points for the beginning and the end of a motif/syllable. Fs is the sampling frequency.
	To have an idea of how a file with the labels (and sample points) can look like in our data, please click <a href="https://i.imgur.com/iYlfiMc.png"> here</a>. 
	To generate the image below we will get from 862331 up to 889794.
	<p><img src="./images/spectrogram.png" alt="" />
	<br> </br>
	<p> <h3> <b> Example 4 - Using psth(spikefile, motifile, fs, basebeg, basend): </b> </h3>
	<p> With this function you can obtain a Peri-Stimulus Time Histogram (PSTH) that works with a time warping method to align all the motifs/renditions to the same mean.
	The mean and standard deviation of the baseline will also be computed for each syllable, allowing further statistical comparison.
	<p><i> * The spikefile is the .txt file that contains the spike times of a channel, it is created by the function createsave(file). 
	Please check the documentation of createsave(file) to know how to obtain the file. </i>
	<p>Now, in this function, one will need the value in time (seconds) that corresponds to the beginning (basebeg) and the end (basend) of a silent period. This is used to compute the baseline firing frequency. Fs is the sampling frequency.
	To have an idea of how a file with the labels (motifile) can look like in our data, please click <a href="https://i.imgur.com/iYlfiMc.png"> here</a>. 
	<p><img src="./images/psthnoblocks.png" width="900" height="550" alt="" />
	<p> <h3> <b> Example 5 - Using powerspectrum(songfile, beg, end, fs): </b> </h3>
	<p> With this function you can obtain a Power Spectrum graph.
	<p><i>* The songfile is a .npy file that contains the analogical signal of the song, created by the function createsave(file).  
	Please check the documentation of createsave(file) to know how to obtain the file.</i>
	<p>Now, in this function, one will need the value in sample points for the beginning and the end of a motif/syllable. Fs is the sampling frequency.
	To have an idea of how a file with the labels (and sample points) can look like in our data, please click <a href="https://i.imgur.com/iYlfiMc.png"> here</a>.
	To generate the image below we will get from 862331 up to 869890, which corresponds to a syllable A.	
	<p><img src="./images/powerspectrum.png" alt="" />
	<br> </br>
	<p> <h3> <b> Example 6 - Using corrpitch(songfile, motifile, lags, window_size,fs,spikefile, means=None): </b> </h3>
	<p> With this function you can obtain the pitch of each note inside a syllable and then perform a correlation between the pitch of the tone and the spiking activity inside a premotor window (default: 50ms), and inside the duration of the tone. To use this function %matplolib must be not inline. *** The same logic is used for corramplitude() and corrspectral().
	<p><i>* The spikefile is the .txt file that contains the spike times of a channel, it is created by the function createsave(file). 
	Please check the documentation of createsave(file) to know how to obtain the file.</i>
	<p>In this function, one will need to define the number of lags for the autocorrelation, a window_size for obtaining the convolved version of the amplitude signal, fs is the sampling frequency, and means is a .txt file that contains the cutting points for the separating the chunks (tones).
	To have an idea of how a file with the labels (motifile) can look like in our data, please click <a href="https://i.imgur.com/iYlfiMc.png"> here</a>.
	<p>This function needs to be explained step by step, so, let's go:
		<ul> Step 1: type corrpitch(songfile, motifile, lags, window_size,fs,spikefile, means=None), with the arguments suitable for your data, in the console.
					<ul><p>In our case it could be  <i> corrpitch("CSC10.npy", "labels.txt", 100, 100,32000,"ch15#1.txt", means=None)</i></p></ul>
			 <p>Step 2: A "Which Syllable?" will be shown in the console, asking for which syllable will be used for the analysis. <i>*Default syllables : A,B,C,D </i></p>
			 <p>Step 3: A graph showing an example of the syllable will appear, just to give the user an idea how many tones/chunks should be cut. Thus, after that the user should answer in the console "Number of chunks?"
			 For the syllable used in this example (syb A), we decided to cut it in 4 chunks.
			 <p><img src="./images/whichsyllable.png" width="500" height="400" alt="" />
			 <p>Step 4: After defining the number of chunks to be cut, 4 random examples of the syllable will pop up asking for the user to click on the plot to define the cutting point/coordinates. After clicking, the user has to either use a key to move to the next plot, or click with the mouse to reset the coordinates and select again.</p>
			 <p><img src="./images/chunkssyb.png" width="500" height="400" alt="" />
			 <p>Step 5: After cutting the tones/chunks, an example of how the syllables will be cut will pop up.</p>
			 <p><img src="./images/tonessyb.png" width="500" height="250" alt="Tones" />
			 <p>Step 6: From now on, a autocorrelation will be performed for each tone. A graph will pop up for each note, showing the results. In our case, we only kept the tones who showed a periodicity/consistency throught the autocorrelation lags.</p>
			 <p><img src="./images/keep.png" width="600" height="300" alt="Keep or not keep" />
			 <p>Step 7: Then, if the user chooses to keep a tone, it will have to click on the graph to stablish the peak in which the pitch can be found.</p>
			 <p><img src="./images/selectpeaks.png" width="450" height="200" alt="Pick Selection" />
			 <p>Step 8: After selecting the peak, the user will be asked if correlations should be performed [Y/n]. If Y, a number of iterations for bootstrapping will be asked, and the correlation analysis will be performed.</p>
			 <p>The code checks for the normality and homocedasticity of the data before performing the correlation test (Pearson or Spearman). Other than that, there is also a check point for the amount of samples (minimum is 3), and also to see if the number of spikes in the correlation columns are not all 0 (this would cause an error for the analysis).
			 <p> All correlation data will be saved in .txt files (Raw data and bootstrapped)
			 <br> </br>
			 <p>Step 9: Finally, the user will be asked if he/she wants to idenfity an possible point of the peak to have an estimation of the pitch. If yes, the final figure will contain an annotation on the clicked coordinate.
			 <p> The final figure will have on the upper left corner a plot of the interpolated version of the peak (to increase precision in the pitch detection). A plot with the distribution of the pitchs (upper left), and the autocorrelation plot (bottom).
			 <p><a href="https://i.imgur.com/iB3Pghg.png"><img src="./images/Figure_2.jpg" width="700" height="400" alt="Final Image"/></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
